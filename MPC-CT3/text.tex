\section{Bezpečnost na~vrstvě L1 (bezpečnostní opatření, klíčování, dohled nad~sítí) a bezpečnost na~vrstvě L2 (bezpečnostní opatření, příklady útoků, MACsec).}

Na~fyzické vrstvě pracují technologie jako USB, Bluetooth, UTMS, 100Base-T, DSL, \dots

Na~spojové vrstvě pracují protokoly Ethernet, PPP; WEP/WPA\{,2,3\}; PAP/CHAP/EAP, \dots


\subsection{Bezpečnostní opatření na~L1}

Zajištění a~izolace kabelů nebo optiky, síťových prvků, ochrana fyzických rozhraní a portů:
\begin{itemize}
	\item Zamezení neautorizovaného připojení do~portů.
	\item Zamezení poškození síťového zařízení.
	\item Umístění bezpečnosti perimetru nebo prostoru (čidla, kamery, kontrola přístupu, uzamykatelné skříně).
	\item Pasivní ochrana: blokátory (pro~konektory a porty), klíčování (znemožnění připojení cizích skupin PatchCordů a LC konektorů).
\end{itemize}

Obfuskace komunikace (kódování, přidání bílého šumu).
Analogové šifrování (různé modulace).
Kvantová kryptografie (distribuce klíčů protokolem BB84).

Šifrování na~první úrovni způsobuje problémy (synchronizace, komplexita, neefektivní ošetření chyb).


\subsection{Dohled nad~L1 sítí}

AIM (\emph{Automatized Infrastrucutre Management}) zajišťuje, dokumentuje a~monituruje síťovou kabeláž.
Umožňuje detekovat vložení a odstranění propojovacích kabelů (pomocí mikrospínač nebo například měřením impedančních vlastností).

IPLMS (\emph{Intelligent Physical-Layer Management Solution}) kombinuje inteligentní propojovací panely se softwarovými funkcemi a poskytuje informaceo~stavu připojení na~portech.


\subsection{Rizika a~hrozby na~L1}

Externí útoky: modifikace dat (\emph{tampering}), rušení (\emph{jamming}), odepření služeb (DoS), odposlech (\emph{sniffing}; bezdrátově, metalikou, optikou, prostorově pomocí kamery nebo mikrofonu), obejití přístupu (\emph{authentication bypass}; lámání hesel, obnovení do~továrního nastavení, nouzový režim, reboot), útok postranním kanálem (proudově, napěťově, zvukově, opticky).

Interní útoky: poškození kabelů nebo zařízení, neoprávněné připojení k~portu (\emph{tap}, \emph{splitter}) a odposlech či modifikace dat.


\subsection{Bezpečnostní opatření na~L2}

Ethernet packet obsahuje pouze CRC32, nelze ho považovat za~bezpečnostní prvek.

802.1x: kontrola přístupu zařízení do~sígě na~portech nebo na~bezdrátových přístupových bodech.
Doporučuje se EAP a integrace s~AAA (Radius, Diameter).

802.11: WEP i WPA obsahují mnoho chyb, WPA2 (802.11i): KRACK (2017), WPA3: zranitelnost v~Dragonfly handshake.


\subsection{Rizika a~hrozby na~L2}

DoS (vyčerpání MAC adres, kolize), odposlech, modifikace dat.

Existuje množství útoků: spoofing MAC adres, \emph{ARP cache poisoning}, \emph{ARP cache flooding}, WEP/WPA zranitelnosti, VLAN útoky.

% TODO Příklady útoků


\subsection{MACSec}

802.1ae je specifikace implementace SecY (\emph{MAC Security Entities}).
Zajišťuje důvěrnost dat, autenticitu i~integritu.
Jako takový nezajišťuje management klíčů a ustanovení bezpečné relace; existuje 802.1x-2010 jako MKA (\emph{\mbox{MACSec} Key Agreement}).

802.1ae+802.1x dohromady zajišťují oboustrannou autentizaci, výměnu klíčů, šifrování, integritu a autentičnost.
Jsou součástí Linuxového jádra 4.5+, některých CISCO přepínačů a dalších L2 prvků.

Protože jde o~ochranu na~L2, chrání data jen uvnitř jednoho LAN segmentu a při~přechodu do~jiné sítě je terminován.
Podporuje VLAN.

Rámce jsou podobné Ethernet rámcům, ale obsahují navíc \emph{Security Tag} a MAC.
Používá se AES-GCM-128 (nebo -256).


\clearpage
\section{Bezpečnost na~vrstvě L3 (bezpečnostní opatření, příklady útoků, IPsec, bezpečnost IPv6).}

L3 je první vrstva na~které je zavádění šifrování praktické i pro~běžné použití.

Zajištění autentizace/autorizace komunikujících stran (PKI, AAA, ACL), důvěrnost (VPN), bezpečnost služeb (ICMP, ARP, IGMP), QoS, bezpečnost protokolů (OSPF, RIP).


\subsection{Bezpečnostní opatření na~L3}

Zabezpečení.
Key management (PKI), autentizace (AAA řešení, Radius, Tacacs, Kerberos), ACL, firewally.

Důvěrnost a integrita.
Bezpečnost je založena na~vyšších vrstvách (TLS, DTLS, QUIC).
IPSec.

Ochrana funkčnosti sítě.
Směrovací protokoly nemívají možnost vzájemné autentizace (OSPFv2, RIPv2, EIGRP, BGP: zcela bez autentizace, případně MD5 PSK).


\subsection{Rizika a~hrozby na~L3}

Spoofing, IP flooding, ICMP flooding, Smurf DDoS (podvržení zdroje v~ICMP dotazu), wormhole, blackhole, sybil.

U~dynamických směrovacích protokolů je možné do~sítě nasadit škodlivé zařízení které může síť ovládnout.


\subsection{IPSec}

IPSec poskytuje bezpečnost na~třetí vrstvě včetně managementu klíčů a ověření protistran.
Jde o~sadu několika protokolů: \emph{Authentication Header} (integrita), \emph{Encapsulating Security Payloads} (šifrování), \emph{Security Associations} (parametry spojení).
Lze ho využívat v~tunelovacím (vše šifrované, nová hlavička) nebo transportním (šifrovaná data) módu.
Ustanovení klíče je možné přes PSK, IKE1/IKE2, Kerberos.

Implementován ve~Windows, OSX, nových verzích Android, pro~Linux \{strong,libre,open\}swan.
Alternativou k~IPSec je např. Wireguard.


\subsection{Bezpečnost IPv6}

V~IPv6 měl být IPSec původně vyžadován, dnes jde však jen o~doporučení.
IPv6 používá nové přístupy a~protokoly které zvětšují prostor pro~možné útoky.
Některé útoky z~v4 lze adaptovat: ARP $\rightarrow$ NDP, broadcast $\rightarrow$ multicast multiplikace, fragmentace (směrovače $\rightarrow$ uzly).
Je možné zneužívat rozšířené hlavičky.

Kvůli výrazně většímu prostoru je v6 odolná vůči skenování; 64b prefix, různé způsoby přidělování adres.

% TODO Bezpečnost multicastu



\clearpage
\section{Bezpečnost TCP (útoky, protiopatření), protokol TLS -- Transport Layer Security (princip, součásti, příklady útoků).}

TCP hlavička obsahuje protichybový checksum.
Při~navazování spojení se provádí třícestný handshake:
\begin{center}
\begin{tabular}{rcl}
	klient & & server \\
	\hline
	SYN, SEQ=$X$ & $\rightarrow$ & \\
	& $\leftarrow$ & SYN, ACK=$X+1$, SEQ=$Y$ \\
	SEQ=$X+1$, ACK=$Y+1$ & $\rightarrow$ \\
\end{tabular}
\end{center}
Při~uzavírání spojení obě strany zasílají FIN, ACK.
Zamítavá odpověď je RST.


\subsection{Útoky na~TCP}

\textbf{Spoofing.}
Asociační stavem se myslí kombinace portu a~inicializačního sekvenčního čísla, které lze predikovat nebo hádat.
Ochranou je dobrá implementace TCP stacku (a PRNG v~něm), IPSec nebo např. TCP Auth Option (RFC~5925).

\textbf{Skenování portů.}
Skenováním lze zjistit jaké služby na~stanici běží, a~fingerprinting techniky umožňují detekovat i verze systému a služeb (\texttt{nmap}, \texttt{netstat}; \href{https://github.com/hackman/shijack}{\texttt{Shijack}}, \href{https://linux.die.net/man/1/hunt}{\texttt{Hunt}}).
Přímá ochrana neexistuje, je možné skenování ztížit nasazením edge proxy která serverům a jejich službám posílá jen žádaný provoz a zbytek je terminován u~ní.

\textbf{Únos TCP relace.}
Varianta spoofingu, jde o~zastavení klienta (DoS) a odhad sekvenčních čísel jeho komunikace se~serverem.

\textbf{SYN DoS.}
Zaslání mnoha SYN paketů bez následného potvrzení navázání spojení ACK zprávou.
Tím na~serveru zůstanou polootevřená spojení.
Ochranou jsou SYN cookies (hashování adres, portů a času; výsledek v~sekvenčním čísle), snížení časovače, navýšení délky fronty, recyklace nejstarších polootevřených spojení, filtrace nových spojení.


\vfill
\subsection{Protokol TLS}

\emph{Transport Layer Security}.
Jde o~mezivrstvu zajištující bezpečný přenos L7 protokolů nad~TCP.
Nabízí jedno- i dvoucestnou autentizaci s~využitím certifikačních autorit, obousměrnou symetricky šifrovanou konverzaci, kontrolu integrity a autentičnosti (HMAC, CMAC, AEAD).

Skládá se z~protokolů \emph{Record Layer Protocol} (dělení dat, komprimace, šifrování), \emph{Handshake Protocol} (autentizace stran, dohoda algoritmů a tajemství), \emph{ChangeCipherSpec} (přechod na~jinou šifrovací sadu), \emph{Alert} (signalizace).

Při~navazování se provádí čtyřcestný handshake:
\begin{center}
\begin{tabular}{rcl}
	klient & & server \\
	\hline
	ClientHello & $\rightarrow$ & \\
	& & ServerHello \\
	& & Certificate \\
	& $\leftarrow$ & ServerHelloDone \\
	ClientKeyExchange & & \\
	ChangeCipherSpec & & \\
	Finished & $\rightarrow$ & \\
	& & ChangeCipherSpec \\
	& $\leftarrow$ & Finished \\
\end{tabular}
\end{center}
Výsledná relace může obsahovat jedno nebo více TCP spojení.


\subsection{Útoky na~TLS}

\textbf{Padding Oracle} (2002).
Chyba v~návrhu SSL (MAC-then-encrypt v~CBC).
Server vyzrazuje jestli je padding správný.

\textbf{POODLE} (Padding Oracle on Downgraded Legacy Encryption; 2014).
Degradace na~SSL~3 a~návazný Padding Oracle.
Ochranou je využít autentizované režimy šifer (AES-GCM), použití encrypt-then-MAC.

\textbf{Renegotiation} (2009).
Nový handshake v~rámci existujícího spojení který nahradil ten původní.
Ochranou je ho zakázat.

\textbf{CRIME} (Compression Ratio Infoleak Made Easy; 2002).
Získání cookies v~HTTPS a SPDY spojení; kompresní metoda DEFLATE nahrazuje opakované bajty a sledováním velikostí odpovědí lze získat informace o~šifrovaném obsahu.
Ochranou je zakázat kompresi.

\textbf{BREACH} (Browser Reconnaissance and Exfiltration via Adaptive Compression of Hypertext; 2013).
Obdoba CRIME využívající HTTP kompresi místo TLS komprese.

\textbf{HeartBleed} (2014).
Chyba v~implementaci OpenSSL, konkrétně v~heartbeat zprávě.
Klient zasílá dotaz obsahující data a~jejich délku a server odpovídá stejnou zprávou.
Zranitelnost HeartBleed spočívala ve~faktu že server použil zadanou délku zprávy a mohl odpovědět částí dat ze~své paměti.


\clearpage
\section{Bezpečnost UDP (útoky, protiopatření, zabezpečení nad~protokolem UDP), bezpečnost DNS, protokol DNSSEC.}



\clearpage
\section{Zabezpečení v~sítích typu Low-Power Wide Area Network (kryptografické ochrany, problémy a~omezení), zabezpečení v mobilních sítích 2G -- 5G (základní principy bezpečnosti pro~2G, 3G a 4G).}



\clearpage
\section{Ochrana~soukromí v ICT (pojmy, typy anonymizace), kryptografické metody zajištující ochranu soukromí, síťové metody poskytující ochranu soukromí a anonymizační nástroje a systémy.}



\clearpage
\section{Forenzní analýza (hlavní cíle, základní principy, vysvětlete časové značky a časovou osu událostí).}



\clearpage
\section{Analýza škodlivého kódu (základní dělení analýz, cíle a metody statické a dynamické analýzy).}



\clearpage
\section{Penetrační testování (rozdíly v penetračním testování realizovaným metodou Ad-hoc a pomocí metodologie, hlavní cíle ASVS metodologie, bezpečnostní úrovně).}



\clearpage
\section{Testování bezpečnosti webové aplikace (vysvětlete zranitelnost Path traversal, co obsahuje testování vstupu pro nahrání souboru).}



